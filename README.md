# üìå Testing‚Äëin‚ÄëPython

## üíª –ß—Ç–æ –≤ –ø—Ä–æ–µ–∫—Ç–µ
–†–∞–±–æ—Ç–∞ —Å —Ç–µ—Å—Ç–∞–º–∏ –≤ Python ‚Äî –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç, –ø–æ–∫–∞–∑—ã–≤–∞—é—â–∏–π:
- ‚úîÔ∏è –∫–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Python‚Äë–∫–æ–¥–∞
- ‚úîÔ∏è –∫–∞–∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å Airflow DAG‚Äë–∏
- ‚úîÔ∏è –∫–∞–∫ –ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ ETL‚Äë–ª–æ–≥–∏–∫–∏
- ‚úîÔ∏è –∫–∞–∫ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è pytest

## üìñ –û–ø–∏—Å–∞–Ω–∏–µ
–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ Airflow‚Äë–ø—Ä–æ–µ–∫—Ç–∞—Ö –∏ –ø—Ä–æ—Å—Ç—ã—Ö —É—Ç–∏–ª–∏—Ç–∞—Ö Python. 
–¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
- ‚úîÔ∏è unit‚Äë—Ç–µ—Å—Ç—ã –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π
- ‚úîÔ∏è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π
- ‚úîÔ∏è –∑–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É
- ‚úîÔ∏è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```md
dags/
  utils_for_orchestration/
    utils_api.py
    utils_transform.py
    utils_load_to_postgres.py
    __init__.py
  etl/
    dag_load_data_to_pg.py

handles/
  oltp/
    execute_custom_query.py
    get_postgres_credentials.py
  dwh/
    create_schema.py
    create_table_for_users.py
simple/
  __init__.py
  main.py
tests/
  dags/
    utils_for_orchestration/
      test_utils_api.py
      test_utils_load_to_postgres.py
  etl/
    test_dag_load_data_to_pg.py
  simple/
    test_foo.py
    test_simple_function.py
    test_typed_simple_function.py
```

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/KimAleksey/Testing-in-Python.git
cd Testing‚Äëin‚ÄëPython
```

### –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install --upgrade pip && \
pip install uv && \
uv venv activate && \
uv install
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å Airflow –∏ DB
```bash
docker compose up -d
```

### –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ DB
–ï—Å–ª–∏ –Ω–µ –º–µ–Ω—è–ª–∏ docker-compose —Ç–æ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞ –±—É–¥–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º:
```text
POSTGRES_DB="demo"
POSTGRES_HOST="localhost"
POSTGRES_PORT=5433
POSTGRES_USER="postgres"
POSTGRES_PASSWORD="postgres"
```
–ï—Å–ª–∏ –ø–æ–º–µ–Ω—è–ª–∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã, –Ω–æ –Ω—É–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –∏—Ö –≤ —Ç–µ–∫—Å—Ç–µ –≤—ã—à–µ –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ —Ñ–∞–π–ª .env.

## üßë‚Äçüíª–ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### –ó–∞–ø—É—Å–∫ DAG
–í–µ–±-—Å–µ—Ä–≤–µ—Ä Airflow –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç–µ http://localhost:8080/, –µ—Å–ª–∏ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–π —Ö–æ—Å—Ç, 
—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–π—Ç–∏ –ø–æ —Ö–æ—Å—Ç—É http://0.0.0.0:8080/.

–í Airflow —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω DAG –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –µ–≥–æ.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ
–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª –ø—Ä–æ—Å—Ç—ã—Ö —Ç–µ—Å—Ç–æ–≤:
```bash
python -m pytest tests/*
```

–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å —Ç–µ—Å—Ç–∞–º–∏:
```bash
python -m pytest tests/dags/utils_for_orchestration/test_utils_load_to_postgres.py::TestSaveDictToPostgres
```

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —Ç–µ–≥–æ–º:
```bash
python -m pytest -m unit
```
